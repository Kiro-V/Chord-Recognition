\documentclass[a4paper, 9pt, twocolumn]{extarticle}
\usepackage{amsmath,graphicx,amssymb,cite}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}

\usepackage{url}
\usepackage{hyperref}

% ********************************************************************
% Hyperreferences
% ********************************************************************
% \hypersetup{%
%   %draft, % hyperref's draft mode, for printing see below
%   colorlinks=true,
%   breaklinks=true, pdfpagemode=UseNone, pageanchor=true, pdfpagemode=UseOutlines,
%   plainpages=false, bookmarksnumbered, bookmarksopen=true, bookmarksopenlevel=1,
%   hypertexnames=true, pdfhighlight=/O,
%   urlcolor=webbrown, linkcolor=RoyalBlue, citecolor=webgreen
% }

\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
    pdftitle={Overleaf Example},
    pdfpagemode=FullScreen,
    }

\usepackage{tikz}

\begin{document}

\date{\normalsize 12.01.2025}

\title{\vspace{-8mm}\textbf{\Large
Chord Recognition\footnote{This is the summary for the reading assignment,
which is part of the exercise of the lecture \emph{Music Processing Analysis}, Winter Term 2023/24,
Friedrich-Alexander Universit\"at Erlangen-N\"urnberg.
Instructor: Prof.\ Dr.\ Meinard M\"uller,
Tutor: Simon Schw\"ar.
}}}

% Hier die Namen und Daten der beteiligten Autoren eintragen
\author{
{
\begin{minipage}{\textwidth}
\center
Quang Hoang Nguyen Vo \\
\small
Friedrich-Alexander University\"at Erlangen-N\"urnberg
\protect\\{} %
\url{quang.nguyen.vo@FAU.de}
\end{minipage}
}
}

\maketitle
\thispagestyle{empty}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
\label{section:introduction}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Harmony plays a vital role in music. It is the concept of combining different sound together in order to create a cohesive sound to the listener.\cite{LOMAS20225}
The most fundamental building block of harmony, at least in Western music, is the chord. A chord is a set of notes played simultaneously, usually consisting of three or more notes. The most basic type of chord is the triad, which consists of three notes played together.

Harmony analysis studies the relationship and progression of chords in a piece of music. It is a crucial part of music theory and is essential for understanding the structure of a piece of music.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Basic Theory of Harmony}
\label{section:theory}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Intervals}
\label{subsection:intervals}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
An interval is the difference in frequency between two pitches or notes.\cite{Mueller21_FMP_SPRINGER} One of the most basic intervals is the octave, which is the interval between two pitches where one pitch has twice or half the frequency of the other.
With this basic interval, we can build other intervals by taking frequency, geometric or note relations into account.
For Western music, which uses twelve-tone equal temperament, there are 12 basic intervals, each is one semitone part from the other.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Chord and Triads}
\label{subsection:triads}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Two or more notes plays simultaneously are called a chord.\cite{karolyi1965introducing} A triad consists of three note played together.
The first note is called the root note, which gives the chord its name. The second and third note are called the third and the fifth, respectively. The major triads, consisting of a root note a major third and a perfect fifth, are often associated with a happy or bright sound. The minor triads, on the other hand, swap a major third for a minor third. They are often associated with a sad or melancholic sound. Aside from these, there are diminished triad and the augmented triad. Both of these triads have a more dissonant sound compared to the major and minor triads, and are often used to create tension in music.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Major and Minor Chords}
\label{subsection:major_minor}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
A chord takes the name of its root note, a root note of A will have a chord \textbf{A}. The major chord is denoted by the chord name, while the minor chord is denoted by the chord name followed by a lowercase \textbf{m}. For example, the major chord with the root note of A is denoted as \textbf{A}, while the minor chord with the root note of A is denoted as \textbf{Am}.

There are several various way to realising a chord, such as root position, first inversion and second inversion. The root position is when the root note is the lowest note in the chord. The first inversion is when the third note is the lowest note in the chord. The second inversion is when the fifth note is the lowest note in the chord. Besides those exists the broken chord or arpeggio, where the notes are played one after the other instead of simultaneously. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Template-based Chord Recognition}
\label{section:template_recognition}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
One of the straighforward method for chord recognition is using pattern matching. Given the chroma sequence $X = (x_1, x_2, \ldots, x_N)$, and a set $\Lambda$ of possible chord labels, the task is to assign each chroma vector $x_n \in \mathbb{R}^{12}$ to a chord label $\lambda \in \Lambda$.
Accounting for 24 major and minor chords, the set $\Lambda$ would be as follows
\begin{equation}
    \Lambda = \{\mathbf{C, C^\#, \ldots, B, Cm, C^\#m, \ldots, Bm }\}.
\end{equation}
For pattern matching,we precompute a set of templates $t_\lambda \in \mathcal{T}, \lambda \in \Lambda$, with each template can be regarded as a chroma vetor that represents a chord. The similarity between a chroma vector $x_n$ and a template $t_\lambda$ is computed using a similarity function $s$.
\begin{equation}
    s: \mathcal{F} \times \mathcal{F} \rightarrow \mathbb{R}
\end{equation}
Then, the template matching procedure is to find the chord label that maximises the similarity between the given chroma vector $x_n$ and the templates $t_\lambda$. Figure \ref{figure:template_matching} illustrates the template matching process.
\begin{equation}
    \lambda_n^* := \arg \max_{\lambda \in \Lambda} s(\mathbf{t}_\lambda,x_n).
\end{equation}

% Draw the flow chart with 2 nodes connect to center node leading to the output node making a shape of an Y
\begin{figure}
    \begin{tikzpicture}
        \tikzstyle{arrow} = [thick,->,>=stealth]

        \node (center) at (0,0) {Compute similarity $s$};
        \node (left) at (-2,1) {Chroma Vector $x_n$};
        \node (right) at (2,1) {Templates $t_\lambda$};
        \node (bottom) at (0,-1) {Chord Label $\lambda_n^*$};
        \draw [arrow] (left) -- (center);
        \draw [arrow] (right) -- (center);
        \draw [arrow] (center) -- (bottom);
    \end{tikzpicture}
    \caption{Template Matching Process}
    \label{figure:template_matching}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{HMM-Based Chord Recognition}
\label{section:HMM_recognition}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Chord progression in music are not arbitary, but rather follow a certain rules. Therefore, one may find that the chord that is being played at a given time is dependent on the chord that was played before. This dependency can be modelled using Hidden Markov Models (HMMs).
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Markov Chains and Transition Probabilities}
\label{subsection:Markov_chain}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
In order to generalise the task, given a set of states of size $l \in N$

\begin{equation}
    \mathcal{A} := \{\alpha_1, \alpha_2, \ldots, \alpha_l\},
\end{equation}

consisting of distinct elements $\alpha_i$ for $i \in [1:l]$, also known as \textbf{states}.\cite{manning1999foundations}
A chord progression can be modelled as a system that can be described at any time instances $n \in N$ by a state $S_n \in \mathcal{A}$.
For simplicity, the system is assumed to be memoryless, this property is expressed as a conditional probability

\begin{equation}
    P(S_n | S_{n-1}, S_{n-2}, \ldots, S_1) = P(S_n | S_{n-1}).
\end{equation}

Other assumptions includes the system being time-invariant. Hence the state transition probability $a_{ij}$ is independent of time $n$ and only depends on the states $S_i$ and $S_j$. 
\begin{equation}
    a_{ij} := P(S_n | S_{n-1}) = P(S_2 | S_1).
\end{equation}
Needless to say these coefficients follow standard probability constraint
\begin{equation}
    \sum_{j=1}^{l} a_{ij} = 1.
\end{equation}

A system that satisfies these properties are called a Markov chain.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Hidden Markov Models}
\label{subsection:HMM}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Based on Markov chain, we extend the concept to Hidden Markov Models (HMMs). Unlike Markov chain, the state sequence is no longer directly observable, hence the name "hidden". Instead, each state can emit entities that are visible to the outside world. As an analogue, we can see the hidden states are the unidentified chord, while the observations are the chroma features of the audio at a given time.

Formally, an HMM is defined by
a sequence of hidden states $\mathcal{A} = \{\alpha_1, \alpha_2, \ldots, \alpha_l\}$, a probability matrix $A = [a_{ij\in [1:l]}]$ of state transition probabilities and vector $C = (c_1, c_2, \ldots, c_l)$ of initial state probabilities.
In case of \textbf{discrete HMM}, the emission space is assumed to be a finite set
\begin{equation}
    \mathcal{B} = \{\beta_1, \beta_2, \ldots, \beta_K\},
\end{equation}
of size $K \in N$. The emission probability matrix $B = [b_{jk}]$ is defined as the probability of emitting observation $\beta_k$ in state $\alpha_j$, it also satisfies the probability constraint like the transition matrix.
In general, a (discrete) HMM is defined by the tuple
\begin{equation}
    \Theta = (\mathcal{A}, A, C, \mathcal{B}, B).
\end{equation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Uncovering}
\label{subsection:implementation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
The task of chord recognition can be seen as an \textbf{uncovering problem}.
Given an input sequence of observation $O = (o_1, o_2, \ldots, o_M)$ and a HMM $\Theta$, the goal is to find the most likely sequence of hidden states $S = (s_1, s_2, \ldots, s_M)$ that generated the observation sequence.
We can use the Viterbi algorithm to find the most likely sequence of hidden states given the observed states. Viterbi algorithm is a dynamic programming algorithm that computes the most likely sequence of hidden states in a HMM. 
The idea is to compute the optimal path to each state at each time step, then use this information to compute the optimal path to the next state.
\begin{equation}
    \delta(i, n) := \max_{(s_1, \ldots ,s_{n})} P[O(1:n), (s_1, s_2, \ldots, s_{n-1}, s_n = \alpha_i)| \Theta].
\end{equation}
$\delta(i,n)$ is highest probability along a single state sequnece $(s_1, \ldots, s_n)$ that ends in state $\alpha_i$ and generates the observation sequence $O(1:n)$. Then the solution is the state sequence or path that yields the maximum value of $\delta(i,n)$. The matrix $\delta$ can be computed recursively as follows
\begin{equation}
    \delta(i, n) = \max_{j \in [1:l]} (\delta(j, n-1) a_{ji} )b_{ik_n}.
\end{equation}
After finding the state sequence, we need to perform \textbf{backtracking} to find the most likely sequence of hidden states. Let $S^*$ be the optimal state sequence, then  the last element $\alpha_{iN}$ is determined by 
\begin{equation}
    i_N = \arg \max_{j \in [1:l]} \delta(j, N).
\end{equation}

Finally, the optimal state sequence is found by backtracking from the last state to the first state.

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \section{Conclusion}
% \label{section:conclusion}
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Here you find some additional LaTex code fragments for including figures and
% references which you may find helpful.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Example for a citation:~\cite{Mueller21_FMP_SPRINGER}.

% Example for figure: Figure~\ref{figure:example}.

\newpage



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliographystyle{abbrv}
\small
\bibliography{references}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\end{document}
